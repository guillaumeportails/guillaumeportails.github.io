var domtof=document.getElementById("photofeed"),domfly=document.getElementById('photo:autoFlyTo'),numPhoto;let tof={};tof.nextPageToken='';const API_KEY='AIzaSyA1IFKmTOXEHiA5w9QHRNOR64pLTk2ZCSw';function gapiLoaded(){console.log('gapi.load'),gapi.load('client',initializeGapiClient)}async function initializeGapiClient(){console.log('gapi.client.init'),await gapi.client.init({apiKey:API_KEY,discoveryDocs:['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest']}),console.log('gapi.client.init-ed'),feedDrive()}numPhoto=0;function fileAdd(a){let b=++numPhoto,c='',d='';try{const e=a.imageMediaMetadata.location.latitude,f=a.imageMediaMetadata.location.longitude,g=`'${a.imageMediaMetadata.time}'`;c=` onmouseover="flyToIf(this,${e.toFixed(6)},${f.toFixed(6)},${b})"`,d=`<center><button disabled="yes">${a.imageMediaMetadata.time}</button></center>`}catch{}return`<hr><div ${c}><a href="${a.webViewLink}" id="photo${b}" target="_blank">`+`<figure><img src="${a.thumbnailLink}" alt="${a.name}"><figcaption>${d}</figcaption></figure></a></div>`}function flyToIf(d,b,c,a){console.log(`flyTo lat,lon=${b},${c} enabled=${domfly.checked} ref=${a}`),domfly.checked&&(typeof a=='number'&&(a=document.getElementById(`photo${a}`).cloneNode(!0)),mapFlyTo(b,c,a))}async function feedDrive(){const b='feedDrive';console.log(`${b}: start`);const d={q:"'1O_tzaI6HPBCR9AlqRbQqzw4JqzZoqfOv' in parents",corpora:"user",trashed:!1,pageSize:4,pageToken:tof.nextPageToken,fields:'nextPageToken,files(name,thumbnailLink,webViewLink,imageMediaMetadata)',orderBy:'createdTime desc'};let c;console.log('calling gapi.client.drive');try{c=await gapi.client.drive.files.list(d)}catch(a){console.log(`photo: Error: ${a}`);return}tof.nextPageToken=c.result.nextPageToken,console.log(`${b} nextToken ${tof.nextPageToken}`);const a=c.result.files;if(!a||a.length==0){console.log('photo: No files found.');return}console.log(`${b} got files[${a.length}]`),domtof.innerHTML+=a.reduce((a,b)=>`${a}${fileAdd(b)}`,'')}function photoUpdate(){console.log('photoUpdate'),feedDrive().catch(function(a){console.log(`photo: catch1=${a}`)})}